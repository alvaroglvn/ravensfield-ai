name: Publish Daily Article

on:
  schedule:
    - cron: "0 0 * * *" # Every day at midnight UTC
  workflow_dispatch: # Allow manual trigger from the GitHub UI

jobs:
  publish:
    runs-on: ubuntu-latest

    steps:
      - name: Trigger article pipeline
        run: |
          curl --fail \
            --max-time 300 \
            --retry 3 \
            --retry-delay 15 \
            --retry-all-errors \
            -X POST https://ravensfield-ai.fly.dev/api/create-article \
            -H "x-admin-secret: ${{ secrets.ADMIN_PASSWORD }}"
